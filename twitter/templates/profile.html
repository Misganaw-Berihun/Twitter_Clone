{% extends 'base.html' %}
{% load static %} 
{% block content %}
{% if profile %}

<div class="container">
  <div class="row">
    <div class="col-8">
      {% if tweets %} 
      {% for tweet in tweets %}

      <div class="card w-75 mb-5">
        <div class="card-body">
          <div class='d-flex'>
          <h5 class="card-title me-2"> 
            {% if tweet.user.profile.profile_image %}
            <img
              src="{{ tweet.user.profile.profile_image.url }}"
              width="50"
              height="50"
              class="rounded-circle"
              alt="{{ profile.user.username }}"
            />

            {% else %}
            <img
              src="{% static 'images/default_profile_pic.png' %}"
              width="50"
              height="50"
              class="rounded-circle"
              alt="{{ profile.user.username }}"
            />
            {% endif %}</h5>
            <div class=''>{{ tweet.user.first_name|title }} {{ tweet.user.last_name|title }} 
              <a class='text-decoration-none' href="{% url 'profile' tweet.user.profile.user.id %}"><p>@{{ tweet.user.username }} </p></a>
             </div>
            </div>
          <p class="card-text mt-2"> {{ tweet.body }}</p>
          <div class="d-flex justify-content-between">
            <p class="card-text"> {{ tweet.created_at}}</p>
            <p class="card-text"> 
              {{ tweet.number_of_likes }} 
              {% if user in tweet.likes.all %}
              <a href="{% url 'tweet_like' tweet.id %}">
                <i class="fa-solid fa-heart" style="color: red"></i>
              </a>
              {% else %}
              <a href="{% url 'tweet_like' tweet.id %}">
                <i class="fa fa-heart-o" style="color: red"></i>
              </a>
              {% endif %}</p>
              <p>{% if request.user.id == profile.user.id %}
                <a href="{% url 'tweet_delete' tweet.id %}"><button class='btn btn-danger'> Delete </button> </a>
                {% endif %}</p>
          </div>
        </div>
      </div>

      {% endfor %}
      {% endif %}
    </div>
    
    <div class="col-4 mt-5">
      <div class='d-flex  mb-3'>
       
        {% if profile.profile_image %}
        <img src="{{ profile.profile_image.url }}" width='100' height='100' class="rounded-circle ms-5 me-2" />
        {% endif %}

        <div class='mt-3'>
          <h4>{{ profile.user.first_name|title }} {{ profile.user.last_name|title }}</h4>
          <h5 class'text-primary'>@{{ profile.user.username }}</h5>
          </div>

      </div>

      <div class="card">
        <h5 class="card-header bg-primary text-white">Follows</h5>
        <div class="card-body">
          <p class="card-text">
            {% for following in profile.follows.all %}
            <a class='text-decoration-none' href="{% url 'profile' following.user.id %}">@{{ following }}</a
            ><br />

            {% endfor %}
          </p>
        </div>
      </div>

      <br /><br />

      <div class="card">
        <h5 class="card-header bg-primary text-white">Followed By</h5>
        <div class="card-body">
          <p class="card-text">
            {% for following in profile.followed_by.all %}
            <a class='text-decoration-none' href="{% url 'profile' following.user.id %}">@{{ following }}</a
            ><br />
            {% endfor %}
          </p>
        </div>
      </div>
      <br />

      <form method="POST">
        {% csrf_token %}
         {% if profile in user.profile.follows.all %}
        <button
          class="btn btn-outline-danger"
          name="follow"
          value="unfollow"
          type="submit"
        >
          Unfollow @{{ profile.user.username|lower}}
        </button>

        {% else %}
        <button
          class="btn btn-outline-primary"
          name="follow"
          value="follow"
          type="submit"
        >
          Follow @{{ profile.user.username|lower}}
        </button>

        {% endif %}
      </form>
      <br />

      {% if request.user.id == profile.user.id %}
      <a href="{% url 'update_user' %}" class="btn btn-outline-primary mb-5"
        >Update Profile</a
      >
      {% endif %}
    </div>
  </div>
</div>
{% endif %}
 {% endblock %}
